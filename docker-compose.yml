version: "3.7"
services:
  api:
    container_name: api
    build: ./api/src
    command: gunicorn -w 4 -k uvicorn.workers.UvicornWorker main:app --bind 0.0.0.0 --log-level info --access-logfile - --reload
    ports:
      - "8000:8000"
    volumes:
      - ./api/src/:/usr/src/
    restart: unless-stopped
    networks:
      - proxy

  nginx:
    image: 'jc21/nginx-proxy-manager:latest'
    restart: unless-stopped
    ports:
      - '80:80'
      - '81:81'
      - '443:443'
    volumes:
      - ./nginx/src/data:/data
      - ./nginx/src/letsencrypt:/etc/letsencrypt
    networks:
      - proxy

networks:
  proxy:
    name: proxy